(this.webpackJsonpcp_assignment=this.webpackJsonpcp_assignment||[]).push([[0],{24:function(e,t,a){e.exports=a(38)},29:function(e,t,a){},30:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(11),o=a.n(l),i=(a(29),a(2)),c=a(3),s=a(5),d=a(4),u=(a(30),a(12));var m=function(){return n.a.createElement("header",null,n.a.createElement("h4",null,"Data Assignment"))},f="Oops..Seems like some error occurred while loading the data. Please refresh the page or try after some time.",p={table:{style:{backgroundColor:"#f0f1f3"}},headRow:{style:{border:"1px solid transparent",borderRadius:"40px"}},headCells:{style:{fontSize:"12px",fontWeight:"bold"}},rows:{style:{border:"1px solid transparent",borderRadius:"40px",marginTop:"7px",color:"#878c92",fontSize:"12px",fontWeight:"500",boxShadow:"0px 0px 8px 0px #dedede","&:hover":{color:"#878c92",backgroundColor:"#fff!important",outline:"none!important"},"&:not(:last-of-type)":{border:"1px solid transparent"}}},pagination:{style:{justifyContent:"center",fontSize:"12px",border:"1px solid transparent",borderRadius:"40px",minHeight:"40px",marginTop:"7px"},pageButtonsStyle:{color:"green"}}},v=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).state={hasError:!1},r}return Object(c.a)(a,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?n.a.createElement("section",{className:"locationSection"},n.a.createElement("p",null," ",f)):this.props.children}}]),a}(n.a.Component),h=a(6);var b=function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"addDataBtn",onClick:function(){return e.showAddUpdateForm()}},"+ Add Data"))},g=[{fieldName:"First Name",fieldId:"firstName",fieldType:"text",fieldRequired:!0,fieldRegEx:"^[a-zA-Z]+$",readOnly:!1,maxLength:20},{fieldName:"Last Name",fieldId:"lastName",fieldType:"text",fieldRequired:!0,fieldRegEx:"^[a-zA-Z]+$",readOnly:!1,maxLength:20},{fieldName:"Address",fieldId:"address",fieldType:"textArea",fieldRequired:!0,fieldRegEx:"^[a-zA-Z0-9, .]+$",readOnly:!1,maxLength:140},{fieldName:"Country",fieldId:"country",fieldType:"select",fieldRequired:!0,fieldOptions:["US","UK","CA","NZ","AU","IN"],fieldRegEx:"",readOnly:!1},{fieldName:"Pincode",fieldId:"pinCode",fieldType:"text",fieldRequired:!0,fieldRegEx:"^[0-9]+$",readOnly:!1,maxLength:6},{fieldName:"State",fieldId:"state",fieldType:"text",fieldRequired:!0,fieldRegEx:"",readOnly:!0}],E=a(10);var y=function(){return n.a.createElement("section",{className:"locationSection noData"},n.a.createElement("div",null,n.a.createElement("p",null,"There is no data added right now. Kindly add your data first.")))},O=a(20),j=a.n(O),S=a(15);var N=function(e){return n.a.createElement("section",{className:"locationSection"},n.a.createElement("p",null," ",e.ErrorMessage))};var x=function(){return n.a.createElement("section",{className:"locationSection loading"},n.a.createElement("div",{className:"lds-roller"},n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null)))};for(var C=function(e){var t=[{name:"First Name",selector:"firstName",sortable:!0},{name:"Last Name",selector:"lastName",sortable:!0},{name:"Address",selector:"address",sortable:!0},{name:"State",selector:"state",sortable:!0},{name:"Pin Code",selector:"pinCode",sortable:!0},{name:"Country",selector:"country",sortable:!0},{cell:function(t){return n.a.createElement("div",null,n.a.createElement(S.a,{className:"editIcon",onClick:e.update.bind(null,t)}),n.a.createElement(S.b,{className:"deleteLocation",onClick:e.delete.bind(null,t)}))},button:!0}],a=e.tabledata,r=e.isResponse,l=e.isError;return r&&!l?0!==a.length?n.a.createElement("section",{className:"locationSection content"},n.a.createElement(j.a,{columns:t,noHeader:!0,highlightOnHover:!0,pagination:!0,paginationComponentOptions:{rowsPerPageText:"Items per page"},dense:!0,size:10,customStyles:p,theme:"solarized",defaultSortField:"serial",data:a})):n.a.createElement(y,null):r&&l?n.a.createElement(N,{ErrorMessage:f}):n.a.createElement(x,null)},w=a(9),D=a(1),k=function(e){return function(t){Object(s.a)(r,t);var a=Object(d.a)(r);function r(){return Object(i.a)(this,r),a.apply(this,arguments)}return Object(c.a)(r,[{key:"render",value:function(){return n.a.createElement("div",{className:this.props.modal?"modal show-modal":"modal"},n.a.createElement("div",{className:"modal-content"},n.a.createElement(e,this.props)))}}]),r}(r.Component)}(function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(e){var r;Object(i.a)(this,a),(r=t.call(this,e)).cancelHandler=function(e){r.props.hideAddUpdateForm(),e.preventDefault(),r.resetData()},r.resetData=function(){r.props.resetData();for(var e={},t=0;t<g.length;t++)e[g[t].fieldId]={value:"",errorState:{error:!1,message:""}};e.id={value:"",errorState:{error:!1,message:""}},r.setState({Error:!1}),r.setState(e)},r.submitHandler=function(e){var t=r.state,a=t.firstName,n=t.lastName,l=t.address,o=t.country,i=t.pinCode,c=t.state;""===a.value||""===n.value||""===l.value||""===o.value||""===i.value||""===c.value?(r.Error=!0,r.setState({Error:!0}),e.preventDefault(),setTimeout((function(){r.setState({Error:!1})}),3e3)):(r.props.addUpdateData(r.state),e.preventDefault(),r.resetData())},r.handleChange=function(e){var t=e.target.name,a=e.target.value;if(0===a.length||"country"===e.target.name||r.detectInputValidation(e))("pinCode"===t||"country"===t)&&0!==r.state.country.value.length&&r.state.pinCode.value.length>3&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout((function(){r.getPincodeState(r.state.pinCode.value,r.state.country.value)}),1500)),r.setState((function(e){return Object(w.a)({},t,Object(D.a)(Object(D.a)({},e[t]),{},{value:a,errorState:Object(D.a)(Object(D.a)({},e[t].errorState),{},{error:!1,message:""})}))}));else{var n;switch(e.target.name){case"firstName":case"lastName":n="Only characters are allowed from A-Z";break;case"address":n="Special Characters are not allowed excluding  [ - and . ]";break;case"pinCode":n="Only number allowed";break;default:n=""}r.setErrorState(t,n)}};var n={};r.timeout=0;for(var l=0;l<g.length;l++)n[g[l].fieldId]={value:"",errorState:{error:!1,message:""}};return r.state=n,r}return Object(c.a)(a,[{key:"setErrorState",value:function(e,t){var a=this;this.setState((function(a){return Object(w.a)({},e,Object(D.a)(Object(D.a)({},a[e]),{},{errorState:Object(D.a)(Object(D.a)({},a[e].errorState),{},{error:!0,message:t})}))})),setTimeout((function(){a.setState((function(t){return Object(w.a)({},e,Object(D.a)(Object(D.a)({},t[e]),{},{errorState:Object(D.a)(Object(D.a)({},t[e].errorState),{},{error:!1,message:""})}))}))}),3e3)}},{key:"detectInputValidation",value:function(e){return!!new RegExp(e.target.attributes.regex.value).test(e.target.value)}},{key:"getPincodeState",value:function(e,t){var a=this;fetch("https://api.worldpostallocations.com/pincode?postalcode=".concat(e,"&countrycode=").concat(t)).then((function(e){return e.json()})).then((function(e){e.result.length>0?(a.setState((function(e){return{pinCode:Object(D.a)(Object(D.a)({},e.pinCode),{},{errorState:Object(D.a)(Object(D.a)({},e.state.errorState),{},{error:!1,message:""})})}})),a.setState((function(t){return{state:Object(D.a)(Object(D.a)({},t.state),{},{value:e.result[0].state,errorState:Object(D.a)(Object(D.a)({},t.state.errorState),{},{error:!1,message:""})})}}))):(a.setState((function(e){return{state:Object(D.a)(Object(D.a)({},e.state),{},{value:""})}})),a.setErrorState("pinCode","Invalid pin code. Please enter a valid pincode."))}),(function(e){a.setErrorState("pinCode","Error while retrieving state for this pin code")}))}},{key:"render",value:function(){var e=this;return n.a.createElement("form",null,g.map((function(t){var a=t.fieldName,r=t.fieldId,l=t.fieldType,o=t.fieldRequired,i=t.fieldOptions,c=t.fieldRegEx,s=t.readOnly,d=t.maxLength,u=e.state[r].errorState;switch(l){case"text":return n.a.createElement("div",{key:r,className:r},n.a.createElement("label",{htmlFor:r,required:o,className:"addUpdateDataLabel"},a),n.a.createElement("input",{type:"text",name:r,autoComplete:"off",readOnly:s,value:e.state[r].value,onChange:e.handleChange,className:"addUpdateDataInput",regex:c,maxLength:d}),u.error&&n.a.createElement("div",{className:"errorMsg"},u.message));case"textArea":return n.a.createElement("div",{key:r,className:r},n.a.createElement("label",{htmlFor:r,required:o,className:"addUpdateDataLabel"},a),n.a.createElement("textarea",{name:r,autoComplete:"off",readOnly:s,value:e.state[r].value,onChange:e.handleChange,className:"addUpdateDataInput",regex:c,maxLength:"140",cols:"73",rows:"3"}),u.error&&n.a.createElement("div",{className:"errorMsg"},u.message));case"select":return n.a.createElement("div",{key:r,className:r},n.a.createElement("label",{className:"addUpdateDataLabel",required:o,htmlFor:r},a),n.a.createElement("select",{type:"text",name:r,value:e.state[r].value,onChange:e.handleChange,className:"addUpdateDataInput"},n.a.createElement("option",{value:""},"Select"),i.map((function(e){return n.a.createElement("option",{key:e,value:e},e)}))));default:return null}})),n.a.createElement("div",{className:"actionBtn"},n.a.createElement("button",{className:"cnclBtn",type:"button",onClick:this.cancelHandler},"Cancel"),n.a.createElement("button",{type:"submit",onClick:this.submitHandler},"Submit")),this.state.Error&&n.a.createElement("div",{className:"errorMsg requiredError"},"Required fields are missing**"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.initialData,r=a.firstName,n=a.lastName,l=a.address,o=a.country,i=a.pinCode;return""!==r.value&&""!==n.value&&""!==l.value&&""!==o.value&&""!==i.value&&""===t.firstName.value&&""===t.lastName.value&&""===t.address.value&&""===t.country.value&&""===t.pinCode.value?e.initialData:null}}]),a}(r.Component)),R={},A=0;A<g.length;A++)R[g[A].fieldId]={value:"",errorState:{error:!1,message:""}};var I=function(){var e=Object(r.useState)(null),t=Object(h.a)(e,2)[1],a=Object(r.useState)(!1),l=Object(h.a)(a,2),o=l[0],i=l[1],c=Object(r.useState)(!1),s=Object(h.a)(c,2),d=s[0],m=s[1],f=Object(r.useState)([]),p=Object(h.a)(f,2),v=p[0],y=p[1],O=Object(u.useIndexedDB)("cpData"),j=O.add,S=O.update,N=O.getAll,x=O.deleteRecord,w=Object(r.useState)(!1),D=Object(h.a)(w,2),A=D[0],I=D[1],T=Object(r.useState)(R),F=Object(h.a)(T,2),U=F[0],L=F[1],q=Object(E.c)((function(e){return e})),P=Object(E.b)();function H(){N().then((function(e){y(e),m(!0),i(!1),P({type:"REFRESH_DATA",payload:!1})}),(function(e){y([]),m(!0),i(!0),t((function(){throw new Error("This is an error")}))}))}return Object(r.useEffect)((function(){H()}),[q.refreshTable]),n.a.createElement(n.a.Fragment,null,n.a.createElement(b,{showAddUpdateForm:function(){return I(!0)}}),n.a.createElement(k,{modal:A,hideAddUpdateForm:function(){return I(!1)},addUpdateData:function(e){var t=Object.keys(e),a={};t.forEach((function(t){"Error"!==t&&(a[t]="id"===t&&(""===e[t].value||void 0===e[t].value)?"":e[t].value)})),""===a.id&&delete a.id,(void 0===a.id?j:S)(a).then((function(e){console.log("ID Generated: ",e),P({type:"REFRESH_DATA",payload:!0})}),(function(e){window.alert(void 0===a.id?"Error while adding data, Please try again!":"Error while updating data, Please try again!")})),I(!1)},initialData:U,resetData:function(){for(var e={},t=0;t<g.length;t++)e[g[t].fieldId]={value:"",errorState:{error:!1,message:""}};L(e)}}),n.a.createElement(C,{isError:o,isResponse:d,tabledata:v,contextData:q,delete:function(e){window.confirm("Are you sure you want to delete:\r ".concat(e.firstName," ").concat(e.lastName,"?"))&&x(e.id).then((function(e){H()}),(function(e){window.alert("Error while deleting data, Please try again!")}))},update:function(e){var t=Object.keys(e),a={};t.forEach((function(t){a[t]={value:e[t],errorState:{error:!1,message:""}}})),L(a),I(!0)},showAddUpdateForm:function(){return I(!0)},hideAddUpdateForm:function(){return I(!1)}}))};Object(u.initDB)({name:"MyDB",version:1,objectStoresMeta:[{store:"cpData",storeConfig:{keyPath:"id",autoIncrement:!0},storeSchema:[{name:"name",keypath:"name",options:{unique:!1}}]}]});var T=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:"LocationApp"},n.a.createElement(m,null),n.a.createElement(v,null,n.a.createElement(I,null)))}}]),a}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var F={refreshTable:!0},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REFRESH_DATA":return Object(D.a)(Object(D.a)({},e),{},{refreshTable:t.payload});default:return e}},L=a(13),q=Object(L.b)(U);o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(E.a,{store:q},n.a.createElement(T,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[24,1,2]]]);
//# sourceMappingURL=main.1379824d.chunk.js.map